# 통합 테스트 가이드

## 개요

이 문서는 QA 자동화 대시보드의 전체 기능을 검증하기 위한 통합 테스트 시나리오를 제공합니다. 프론트엔드 UI, 백엔드 API, GitHub Actions 워크플로우의 상호작용을 검증합니다.

---

## 테스트 환경 설정

### 사전 요구사항

1. **Node.js 18+ 설치**
   ```bash
   node --version  # v18.0.0 이상
   ```

2. **GitHub 토큰 설정**
   ```bash
   export GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxx
   export GITHUB_REPO_OWNER=your-org
   export GITHUB_REPO_NAME=qa-automation
   export GITHUB_WORKFLOW_ID=qa-tests.yml
   ```

3. **프로젝트 의존성 설치**
   ```bash
   npm install
   npm run build
   ```

4. **개발 서버 시작**
   ```bash
   npm run dev
   ```

---

## 테스트 시나리오

### 테스트 케이스 1: URL 입력 및 유효성 검증

**목표:** URL 입력 필드의 유효성 검증 기능 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | URL 입력 필드에 `example.com` 입력 | 입력 필드에 텍스트 표시 |
| 2 | 테스트 선택 없이 "테스트 실행" 클릭 | 에러 메시지: "최소 1개 이상의 테스트를 선택해주세요." |
| 3 | 빈 URL로 "테스트 실행" 클릭 | 에러 메시지: "테스트할 URL을 입력해주세요." |
| 4 | 유효하지 않은 URL `invalid url` 입력 후 실행 | 에러 메시지: "유효한 URL 형식이 아닙니다." |
| 5 | 유효한 URL `https://example.com` 입력 | 입력 필드에 URL 표시 |

**검증 기준:**
- ✅ 모든 에러 메시지가 명확하게 표시됨
- ✅ 유효한 URL은 정상 처리됨
- ✅ `https://` 프로토콜 자동 추가 기능 작동

---

### 테스트 케이스 2: 테스트 유형 선택

**목표:** 테스트 유형 체크박스 선택 기능 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | "Lighthouse 성능 확인" 체크박스 클릭 | 체크박스 선택됨 |
| 2 | "Responsive Viewer 화면 확인" 체크박스 클릭 | 체크박스 선택됨 |
| 3 | "AI UX 리뷰" 체크박스 클릭 | 체크박스 선택됨 |
| 4 | "TC 작성 및 수행" 체크박스 클릭 | 체크박스 선택됨 |
| 5 | 선택된 테스트 체크박스 다시 클릭 | 체크박스 선택 해제됨 |
| 6 | 모든 테스트 선택 후 "테스트 실행" 버튼 상태 확인 | 버튼이 활성화됨 |

**검증 기준:**
- ✅ 모든 체크박스가 독립적으로 작동
- ✅ 선택 상태가 정확히 반영됨
- ✅ 최소 1개 선택 시 버튼 활성화

---

### 테스트 케이스 3: 테스트 실행 및 상태 모니터링

**목표:** 테스트 실행 및 상태 폴링 기능 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | URL 입력 및 테스트 선택 후 "테스트 실행" 클릭 | 상태 영역이 나타나고 "테스트 실행 중" 표시 |
| 2 | 5초 대기 후 상태 확인 | 각 테스트별 진행 상황 표시 (⏳ 또는 ✅) |
| 3 | 모든 테스트 완료 대기 | "테스트 완료" 상태로 변경 |
| 4 | 결과 요약 영역 확인 | 각 테스트별 결과 카드 표시 |
| 5 | 상세 리포트 링크 클릭 | GitHub Actions 페이지로 이동 |

**검증 기준:**
- ✅ 상태가 실시간으로 업데이트됨
- ✅ 폴링 간격이 약 5초
- ✅ 완료 후 결과가 정확히 표시됨
- ✅ 링크가 정상 작동

---

### 테스트 케이스 4: 결과 요약 표시

**목표:** 테스트 결과 요약 카드의 정확성 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | 테스트 완료 후 결과 영역 확인 | 4개의 결과 카드 표시 (성능, 화면, UX, TC) |
| 2 | 성능 카드 확인 | Lighthouse 점수 및 개선 항목 표시 |
| 3 | 화면 카드 확인 | 데스크톱/태블릿/모바일 캡처 정보 표시 |
| 4 | UX 카드 확인 | AI 리뷰 결과 및 개선점 표시 |
| 5 | TC 카드 확인 | 통과/실패 수 및 성공률 표시 |
| 6 | 각 카드의 "상세 리포트 보기" 버튼 클릭 | 해당 리포트 페이지로 이동 |

**검증 기준:**
- ✅ 모든 결과 카드가 올바르게 표시됨
- ✅ 정보가 명확하고 이해하기 쉬움
- ✅ 링크가 정상 작동

---

### 테스트 케이스 5: 에러 처리

**목표:** 에러 상황에서의 UI 동작 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | 네트워크 연결 끊김 상태에서 테스트 실행 | 에러 메시지 표시 |
| 2 | 존재하지 않는 URL로 테스트 실행 | 워크플로우 실패 후 에러 상태 표시 |
| 3 | 에러 상태에서 "다시 테스트하기" 버튼 클릭 | 입력 영역으로 돌아감 |
| 4 | 5분 이상 폴링 후 타임아웃 | "테스트 실행 시간 초과" 에러 표시 |

**검증 기준:**
- ✅ 에러 메시지가 명확함
- ✅ 사용자가 복구할 수 있는 옵션 제공
- ✅ 타임아웃이 정상 작동

---

### 테스트 케이스 6: 반응형 디자인

**목표:** 다양한 화면 크기에서의 UI 동작 확인

**테스트 단계:**

| 단계 | 작업 | 예상 결과 |
| --- | --- | --- |
| 1 | 모바일 뷰포트 (375px) 확인 | 레이아웃이 단일 컬럼으로 표시 |
| 2 | 태블릿 뷰포트 (768px) 확인 | 레이아웃이 2컬럼으로 표시 |
| 3 | 데스크톱 뷰포트 (1920px) 확인 | 레이아웃이 3컬럼으로 표시 |
| 4 | 모바일에서 버튼 크기 확인 | 버튼이 최소 44px 높이 |
| 5 | 모바일에서 입력 필드 크기 확인 | 입력 필드가 터치 친화적 크기 |

**검증 기준:**
- ✅ 모든 화면 크기에서 레이아웃이 정상
- ✅ 텍스트가 읽기 쉬운 크기
- ✅ 버튼이 터치 친화적

---

## API 통합 테스트

### API 테스트 1: 테스트 실행 트리거

**테스트 코드:**
```bash
curl -X POST http://localhost:3000/api/run-test \
  -H "Content-Type: application/json" \
  -d '{
    "targetUrl": "https://example.com",
    "tests": ["performance", "responsive"]
  }'
```

**예상 응답:**
```json
{
  "success": true,
  "runId": "1234567890",
  "message": "테스트가 시작되었습니다."
}
```

**검증 기준:**
- ✅ HTTP 상태 코드 200
- ✅ `runId` 필드 포함
- ✅ GitHub Actions 워크플로우 실제 트리거됨

---

### API 테스트 2: 상태 조회

**테스트 코드:**
```bash
curl http://localhost:3000/api/test-status/1234567890
```

**예상 응답:**
```json
{
  "status": "running",
  "conclusion": null,
  "results": {
    "performance": {
      "status": "running",
      "summary": "...",
      "details": "...",
      "link": "..."
    }
  },
  "runUrl": "https://github.com/..."
}
```

**검증 기준:**
- ✅ HTTP 상태 코드 200
- ✅ 상태가 `running` 또는 `completed`
- ✅ 결과 데이터 구조가 정확

---

## 성능 테스트

### 성능 테스트 1: 페이지 로딩 시간

**측정 항목:**
- 초기 페이지 로드: < 2초
- 상태 폴링 응답: < 500ms
- 결과 렌더링: < 1초

**테스트 방법:**
```javascript
// 브라우저 개발자 도구 Performance 탭에서 측정
const startTime = performance.now();
// ... 작업 수행 ...
const endTime = performance.now();
console.log(`소요 시간: ${endTime - startTime}ms`);
```

---

### 성능 테스트 2: 메모리 사용량

**측정 항목:**
- 초기 메모리: < 50MB
- 폴링 중 메모리: < 100MB
- 결과 표시 후: < 150MB

**테스트 방법:**
```javascript
// 브라우저 개발자 도구 Memory 탭에서 측정
console.memory.usedJSHeapSize / 1048576; // MB 단위
```

---

## 체크리스트

완료 전 다음 항목을 확인하세요:

- [ ] 모든 URL 유효성 검증 테스트 통과
- [ ] 모든 테스트 유형 선택 테스트 통과
- [ ] 테스트 실행 및 상태 모니터링 테스트 통과
- [ ] 결과 요약 표시 테스트 통과
- [ ] 에러 처리 테스트 통과
- [ ] 반응형 디자인 테스트 통과
- [ ] API 통합 테스트 통과
- [ ] 성능 테스트 통과
- [ ] 브라우저 호환성 테스트 통과 (Chrome, Firefox, Safari, Edge)
- [ ] 접근성 테스트 통과 (키보드 네비게이션, 스크린 리더)

---

## 문제 해결

### 테스트가 시작되지 않음
1. GitHub 토큰 설정 확인
2. 저장소 정보 확인
3. 네트워크 연결 확인
4. 브라우저 콘솔 에러 확인

### 상태 폴링이 작동하지 않음
1. 개발자 도구 Network 탭에서 API 호출 확인
2. 서버 로그 확인
3. 폴링 간격 확인 (기본값: 5초)

### 결과가 표시되지 않음
1. GitHub Actions 워크플로우 완료 확인
2. Artifacts 업로드 확인
3. 브라우저 캐시 삭제 후 재시도

---

## 참고 자료

- [Jest 테스트 프레임워크](https://jestjs.io/)
- [React Testing Library](https://testing-library.com/react)
- [Playwright E2E 테스트](https://playwright.dev/)
